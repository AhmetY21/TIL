---
title: "Visualizing Embeddings (t-SNE, PCA)"
date: "2026-02-18"
week: 8
lesson: 3
slug: "visualizing-embeddings-t-sne-pca"
---

# Topic: Visualizing Embeddings (t-SNE, PCA)

## 1) Formal definition (what is it, and how can we use it?)

Visualizing embeddings, particularly using techniques like t-distributed Stochastic Neighbor Embedding (t-SNE) and Principal Component Analysis (PCA), is a crucial process in NLP for understanding the structure and relationships within high-dimensional vector representations of words, phrases, sentences, or even documents. These embeddings are generated by various NLP models like Word2Vec, GloVe, BERT, and others. Due to their high dimensionality (often hundreds or thousands of dimensions), it is difficult to directly interpret or analyze them. Dimensionality reduction techniques are used to project these high-dimensional embeddings onto a lower-dimensional space (typically 2D or 3D) that can be visualized on a scatter plot.

**PCA (Principal Component Analysis):** A linear dimensionality reduction technique that identifies orthogonal principal components (axes) in the data that capture the maximum variance. It projects the data onto these components, effectively reducing the number of dimensions while retaining as much information as possible about the original data's variance. PCA is relatively fast and simple but can sometimes fail to capture complex non-linear relationships.

**t-SNE (t-distributed Stochastic Neighbor Embedding):** A non-linear dimensionality reduction technique that aims to preserve the local structure of the data. It models the probability distribution of neighbors around each point in both the high-dimensional space and the low-dimensional space, then minimizes the Kullback-Leibler (KL) divergence between these distributions. t-SNE excels at revealing clusters in the data but is computationally more expensive than PCA and sensitive to parameter tuning.  It's mainly used for visualization and not for feature engineering.

**How can we use it?**

*   **Understanding Word Semantics:** By visualizing word embeddings, we can observe which words are clustered together, revealing semantic relationships. For instance, "king," "queen," "prince," and "princess" might form a cluster, illustrating that they share a similar meaning related to royalty.
*   **Evaluating Embedding Quality:** Visualizations can help assess the quality of embeddings. A well-trained embedding space should show meaningful clusters reflecting the underlying data structure. Overlapping or poorly separated clusters might indicate problems with the training data or model.
*   **Identifying Biases:** Visualizing embeddings can uncover biases encoded in the data or the model. For example, gender stereotypes may become apparent if words associated with certain professions are clustered with words associated with a specific gender.
*   **Document/Sentence Similarity:** Sentence embeddings can be reduced and visualized to understand relationships between sentences or documents. Clustering will show groups of sentences with similar meaning or topic.
*   **Model Debugging:** Can help identify anomalies and outliers in the embedded data, which can then guide investigation into the model.

## 2) Application scenario

**Scenario:** Imagine you have trained a Word2Vec model on a large corpus of news articles related to finance. You want to understand how different financial terms are related to each other according to the model.

**Steps:**

1.  **Generate Word Embeddings:** Use your trained Word2Vec model to obtain word embeddings for relevant financial terms like "inflation," "interest rate," "stock market," "bond," "GDP," "unemployment," etc.
2.  **Dimensionality Reduction:** Apply t-SNE to reduce the high-dimensional word embeddings (e.g., 100 dimensions) to 2 or 3 dimensions. This allows you to plot the words on a scatter plot.
3.  **Visualization:** Create a scatter plot where each point represents a word. Use different colors or shapes to highlight specific categories of words (e.g., macroeconomic indicators, investment instruments).
4.  **Interpretation:** Analyze the plot to identify clusters of related words. For example, you might observe that "inflation" and "interest rate" are clustered together, reflecting their close relationship in economics.  Similarly, "stock market" and "bond" might form another cluster representing investment options. You could also discover unexpected relationships, such as "GDP" being closer to "unemployment" than expected, indicating a model focus on their inverse relationship.

## 3) Python method (if possible)

```python
import numpy as np
from sklearn.manifold import TSNE
from sklearn.decomposition import PCA
import matplotlib.pyplot as plt

# Sample data (replace with your actual word embeddings)
# This is a dictionary where keys are words and values are their embeddings.
# In a real scenario this would come from your trained word2vec model.
embeddings = {
    "king": np.array([0.1, 0.2, 0.3, 0.4, 0.5]),
    "queen": np.array([0.15, 0.25, 0.35, 0.45, 0.55]),
    "man": np.array([0.6, 0.7, 0.8, 0.9, 1.0]),
    "woman": np.array([0.65, 0.75, 0.85, 0.95, 1.05]),
    "apple": np.array([0.2, 0.8, 0.1, 0.9, 0.4]),
    "banana": np.array([0.25, 0.75, 0.15, 0.85, 0.45])
}

words = list(embeddings.keys())
embedding_vectors = np.array(list(embeddings.values()))

# --- Using t-SNE ---
tsne = TSNE(n_components=2, perplexity=3, random_state=42)  # Adjust parameters as needed
reduced_embeddings_tsne = tsne.fit_transform(embedding_vectors)

# Plotting t-SNE results
plt.figure(figsize=(8, 6))
for i, word in enumerate(words):
    plt.scatter(reduced_embeddings_tsne[i, 0], reduced_embeddings_tsne[i, 1], marker='o', color='blue')
    plt.annotate(word, xy=(reduced_embeddings_tsne[i, 0], reduced_embeddings_tsne[i, 1]), xytext=(5, 2),
                 textcoords='offset points', ha='right', va='bottom')
plt.title("t-SNE Visualization of Word Embeddings")
plt.xlabel("Dimension 1")
plt.ylabel("Dimension 2")
plt.show()

# --- Using PCA ---
pca = PCA(n_components=2)
reduced_embeddings_pca = pca.fit_transform(embedding_vectors)

# Plotting PCA results
plt.figure(figsize=(8, 6))
for i, word in enumerate(words):
    plt.scatter(reduced_embeddings_pca[i, 0], reduced_embeddings_pca[i, 1], marker='o', color='red')
    plt.annotate(word, xy=(reduced_embeddings_pca[i, 0], reduced_embeddings_pca[i, 1]), xytext=(5, 2),
                 textcoords='offset points', ha='right', va='bottom')
plt.title("PCA Visualization of Word Embeddings")
plt.xlabel("Principal Component 1")
plt.ylabel("Principal Component 2")
plt.show()
```

**Explanation:**

1.  **Import Libraries:** Import necessary libraries like `numpy` for numerical operations, `TSNE` and `PCA` from `sklearn.manifold` and `sklearn.decomposition` respectively for dimensionality reduction, and `matplotlib` for plotting.
2.  **Prepare Data:** The code starts with a sample dictionary called `embeddings`.  In a real-world scenario, this would be populated with the output vectors from the chosen embedding model (like Word2Vec, GloVe, BERT, etc.). The sample contains simple vectors for a few common words to make the visualization code runnable. We convert the embeddings into a NumPy array for processing.
3.  **t-SNE:** The code then initializes a `TSNE` object with the desired number of components (2 for 2D visualization) and a `perplexity` parameter. The `perplexity` is a crucial parameter in t-SNE which relates to the number of nearest neighbors used in the algorithm. A suitable value for perplexity can be between 5 and 50. The `fit_transform` method applies t-SNE to the embedding vectors and reduces them to 2 dimensions.
4.  **PCA:** An instance of PCA is created and applied to reduce the embedding vectors.
5.  **Plotting:** The code uses `matplotlib` to create a scatter plot of the reduced embeddings. Each word is represented as a point on the plot, and the word label is added as an annotation.

## 4) Follow-up question

How can we quantitatively evaluate the quality of a word embedding space, aside from qualitative visualization? Are there any metrics that can tell us if one set of embeddings is "better" than another, and what are some of the limitations of these evaluation metrics?