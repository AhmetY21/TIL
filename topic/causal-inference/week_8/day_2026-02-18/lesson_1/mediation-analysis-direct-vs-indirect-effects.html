<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Mediation Analysis: Direct vs Indirect Effects</title>
  <script>
    if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
      document.documentElement.classList.add('dark');
    } else {
      document.documentElement.classList.remove('dark');
    }
  </script>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      line-height: 1.6;
      max-width: 900px;
      margin: 0 auto;
      padding: 24px;
      color: #111827;
      background: #ffffff;
    }
    h1, h2, h3 { color: #111827; }
    a { color: #2563eb; text-decoration: none; }
    a:hover { text-decoration: underline; }
    code { background-color: #f3f4f6; padding: 2px 6px; border-radius: 6px; }
    pre { background-color: #0b1020; color: #e5e7eb; padding: 16px; border-radius: 10px; overflow-x: auto; }
    pre code { background: transparent; padding: 0; }
    blockquote { border-left: 4px solid #e5e7eb; margin: 0; padding-left: 16px; color: #4b5563; }
    table { width: 100%; border-collapse: collapse; margin: 16px 0; }
    th, td { border: 1px solid #e5e7eb; padding: 8px; text-align: left; }
    th { background: #f9fafb; }
    hr { border: none; border-top: 1px solid #e5e7eb; margin: 24px 0; }

    .page-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 24px;
      padding-bottom: 16px;
      border-bottom: 1px solid #e5e7eb;
    }
    .back-link {
      font-weight: 600;
      text-decoration: none;
    }
    .back-link:hover {
      text-decoration: underline;
    }

    .theme-toggle {
      background: none;
      border: none;
      cursor: pointer;
      font-size: 1.5rem;
      padding: 8px;
      border-radius: 50%;
      transition: background 0.2s;
    }
    .theme-toggle:hover {
      background: rgba(0,0,0,0.05);
    }
    .dark .theme-toggle:hover {
      background: rgba(255,255,255,0.1);
    }

    .dark body {
      background: #0f172a;
      color: #e2e8f0;
    }
    .dark h1, .dark h2, .dark h3 { color: #f1f5f9; }
    .dark a { color: #60a5fa; }
    .dark .page-header { border-bottom-color: #334155; }
    .dark code { background-color: #1e293b; color: #e2e8f0; }
    .dark pre {
      border: 1px solid #334155;
    }
    .dark blockquote {
      border-left-color: #334155;
      color: #94a3b8;
    }
    .dark th, .dark td { border-color: #334155; }
    .dark th { background: #1e293b; }
    .dark hr { border-top-color: #334155; }

    /* Copy Button */
    pre { position: relative; }
    .copy-button {
      position: absolute;
      top: 8px;
      right: 8px;
      padding: 4px 8px;
      font-size: 0.8rem;
      color: #94a3b8;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 4px;
      cursor: pointer;
      opacity: 0;
      transition: opacity 0.2s, background 0.2s;
    }
    pre:hover .copy-button, .copy-button:focus {
      opacity: 1;
    }
    .copy-button:hover {
      background: rgba(255, 255, 255, 0.2);
      color: #e2e8f0;
    }

    .skip-link {
      position: absolute;
      top: -40px;
      left: 0;
      background: #2563eb;
      color: white;
      padding: 8px;
      z-index: 100;
    }
    .skip-link:focus {
      top: 0;
    }

  </style>
</head>
<body>
  <a href="#main-content" class="skip-link">Skip to content</a>

  <div class="page-header">
    <a href="../../../../../hubs/causal-inference-index.html" class="back-link">‚Üê Back to Causal Inference</a>
    <button id="theme-toggle" class="theme-toggle" aria-label="Toggle Dark Mode">üåô</button>
  </div>

<main id="main-content" tabindex="-1">
<h1 id="topic-mediation-analysis-direct-vs-indirect-effects">Topic: Mediation Analysis: Direct vs Indirect Effects</h1>
<h2 id="1-formal-definition-what-is-it-and-how-can-we-use-it">1) Formal definition (what is it, and how can we use it?)</h2>
<p>Mediation analysis is a statistical technique used to understand <em>how</em> an independent variable (X, the cause) influences a dependent variable (Y, the outcome) through one or more mediating variables (M, the mediator).  It aims to decompose the total effect of X on Y into:</p>
<ul>
<li>
<p><strong>Direct Effect:</strong> The effect of X on Y that is <em>not</em> transmitted through the mediator M. It's the causal pathway X -&gt; Y directly.  This is often denoted as <em>c'</em>.</p>
</li>
<li>
<p><strong>Indirect Effect:</strong> The effect of X on Y that <em>is</em> transmitted through the mediator M. It's the causal pathway X -&gt; M -&gt; Y.  This is often calculated as the product of the effect of X on M (<em>a</em>) and the effect of M on Y controlling for X (<em>b</em>), hence <em>a</em> * b*.</p>
</li>
<li>
<p><strong>Total Effect:</strong> The overall effect of X on Y, irrespective of whether it's direct or indirect.  It's often denoted as <em>c</em>.  Ideally, the total effect equals the sum of the direct and indirect effects (c = c' + a*b), though this holds true most clearly in linear models.</p>
</li>
</ul>
<p>We use mediation analysis to:</p>
<ul>
<li><strong>Explain causal mechanisms:</strong>  Uncover the processes through which a cause leads to an effect.  Instead of just knowing that X influences Y, we learn <em>why</em> and <em>how</em>.</li>
<li><strong>Identify intervention points:</strong> If we understand that X affects Y through M, we can target M with interventions to modify Y.</li>
<li><strong>Evaluate interventions:</strong> Assess whether an intervention works as intended by verifying that it influences the proposed mediator and that changes in the mediator lead to changes in the outcome.</li>
<li><strong>Explore complex causal pathways:</strong>  Handle scenarios with multiple mediators and more complex relationships.</li>
</ul>
<p>Key Assumptions:</p>
<ul>
<li><strong>Causal Ordering:</strong> X causes M, and both X and M cause Y.  The assumed temporal order is crucial.</li>
<li><strong>No Unmeasured Confounding:</strong>  There are no unmeasured variables that affect both X and M, both M and Y (controlling for X), or both X and Y.  This is a crucial and often difficult-to-satisfy assumption.</li>
<li><strong>Linearity (often assumed):</strong> The relationships between X, M, and Y are linear.  While extensions exist for non-linear relationships, the classic approach assumes linearity.  Generalized Linear Models (GLMs) can handle non-normal outcomes.</li>
<li><strong>Additivity (often assumed):</strong> Effects are additive. This implies that the effect of M on Y doesn't depend on the value of X.</li>
</ul>
<h2 id="2-application-scenario">2) Application scenario</h2>
<p>Imagine a study investigating the impact of a new exercise program (X) on overall happiness (Y). Researchers suspect that the exercise program improves physical fitness (M), which in turn leads to increased happiness.</p>
<ul>
<li><strong>X:</strong> Participation in the exercise program (binary: yes/no)</li>
<li><strong>M:</strong> Physical fitness level (measured on a scale)</li>
<li><strong>Y:</strong> Overall happiness (measured on a scale)</li>
</ul>
<p>Mediation analysis can help determine:</p>
<ul>
<li><strong>Direct Effect:</strong> Does the exercise program <em>directly</em> increase happiness, even without considering changes in fitness levels? (X -&gt; Y)</li>
<li><strong>Indirect Effect:</strong> Does the exercise program increase happiness <em>because</em> it improves physical fitness? (X -&gt; M -&gt; Y)</li>
<li><strong>Total Effect:</strong> What is the overall impact of the exercise program on happiness, combining both direct and indirect effects? (X -&gt; Y, total causal influence)</li>
</ul>
<p>Understanding the relative magnitudes of the direct and indirect effects can inform the researchers about the most important mechanisms driving the increase in happiness. If the indirect effect is much larger than the direct effect, it suggests that improving physical fitness is the primary pathway through which the exercise program enhances happiness.  Interventions might then focus on maximizing fitness gains from the program.  Conversely, a large direct effect suggests other factors may be at play, and further investigation is warranted.</p>
<h2 id="3-python-method-if-possible">3) Python method (if possible)</h2>
<p>The <code>statsmodels</code> and <code>pymc</code> packages provide ways to conduct mediation analysis in Python.  Here's an example using <code>statsmodels</code>:</p>
<pre class="codehilite"><code class="language-python">import statsmodels.formula.api as smf
import pandas as pd

# Sample data (replace with your actual data)
data = {'X': [0, 1, 0, 1, 0, 1, 0, 1, 0, 1],
        'M': [2, 5, 3, 6, 1, 4, 2, 7, 3, 5],
        'Y': [4, 8, 5, 9, 3, 7, 4, 10, 5, 8]}
df = pd.DataFrame(data)

# Equation 1: Mediator model (X -&gt; M)
model_M = smf.ols('M ~ X', data=df).fit()
print(&quot;Mediator Model:&quot;)
print(model_M.summary())

# Equation 2: Outcome model (X + M -&gt; Y)
model_Y = smf.ols('Y ~ X + M', data=df).fit()
print(&quot;\nOutcome Model:&quot;)
print(model_Y.summary())

# Calculate the indirect effect (a*b)
a = model_M.params['X']  # Effect of X on M
b = model_Y.params['M']  # Effect of M on Y (controlling for X)
indirect_effect = a * b

# Calculate the direct effect (c')
direct_effect = model_Y.params['X']  # Effect of X on Y (controlling for M)

# Calculate the total effect (c) (obtained from a regression of Y on X alone)
model_total = smf.ols('Y ~ X', data=df).fit()
total_effect = model_total.params['X'] # Effect of X on Y (without M in the model)

print(f&quot;\nIndirect Effect (a*b): {indirect_effect}&quot;)
print(f&quot;Direct Effect (c'): {direct_effect}&quot;)
print(f&quot;Total Effect (c): {total_effect}&quot;)

# For significance testing of the indirect effect, bootstrapping or other methods
# like the Sobel test are often used (beyond the scope of this basic example).

#Bootstrapping with Statsmodels:

import numpy as np

def get_indirect_effect(data):
  model_M_boot = smf.ols('M ~ X', data=data).fit()
  model_Y_boot = smf.ols('Y ~ X + M', data=data).fit()
  a_boot = model_M_boot.params['X']
  b_boot = model_Y_boot.params['M']
  return a_boot * b_boot

n_bootstraps = 1000
indirect_effects = []

for _ in range(n_bootstraps):
    #Resample data with replacement
    resample = df.sample(frac=1, replace=True)
    indirect_effects.append(get_indirect_effect(resample))

#Calculate confidence interval from the bootstrapped indirect effects.
lower_ci = np.percentile(indirect_effects, 2.5)
upper_ci = np.percentile(indirect_effects, 97.5)

print(f&quot;\nBootstrapped 95% Confidence Interval for Indirect Effect: ({lower_ci:.4f}, {upper_ci:.4f})&quot;)
</code></pre>

<p><strong>Explanation:</strong></p>
<ol>
<li><strong>Data:</strong>  Create a Pandas DataFrame with columns for X, M, and Y.  <em>Replace the sample data with your actual data.</em></li>
<li><strong>Mediator Model (X -&gt; M):</strong> Fit a regression model predicting M from X.  The coefficient for X (a) represents the effect of X on M.</li>
<li><strong>Outcome Model (X + M -&gt; Y):</strong> Fit a regression model predicting Y from both X and M. The coefficient for M (b) represents the effect of M on Y, <em>controlling for X</em>.  The coefficient for X (c') represents the direct effect of X on Y, <em>controlling for M</em>.</li>
<li><strong>Calculations:</strong> Calculate the indirect effect (a*b), direct effect (c'), and total effect (estimated by regressing Y on X alone).</li>
<li><strong>Bootstrapping:</strong><ul>
<li>The <code>get_indirect_effect</code> function calculates the indirect effect from a given dataset.</li>
<li>The code then resamples the data with replacement <code>n_bootstraps</code> times, calculating the indirect effect for each resampled dataset.</li>
<li>Finally, it calculates a 95% confidence interval for the indirect effect using the percentile method.  If this confidence interval does not contain zero, it provides evidence that the indirect effect is statistically significant.</li>
</ul>
</li>
</ol>
<p><strong>Important Notes:</strong></p>
<ul>
<li>The <code>statsmodels</code> package primarily uses frequentist statistics. For Bayesian mediation analysis, consider the <code>pymc</code> package.</li>
<li>The provided code demonstrates a basic approach.  More advanced methods, such as bootstrapping or Sobel tests, are needed for assessing the statistical significance of the indirect effect.  The example shows bootstrapping.</li>
<li>Carefully check the assumptions of mediation analysis.  Violations of these assumptions can lead to biased results.</li>
<li>Consider using causal identification techniques (e.g., instrumental variables, front-door criterion) to address unmeasured confounding.</li>
</ul>
<h2 id="4-follow-up-question">4) Follow-up question</h2>
<p>How does the interpretation of direct and indirect effects change when dealing with non-linear relationships between X, M, and Y? What specific statistical techniques or modeling approaches are better suited for these scenarios compared to standard linear regression?</p>
</main>
  <script>
    const btn = document.getElementById('theme-toggle');
    const html = document.documentElement;
    
    function updateIcon() {
      btn.textContent = html.classList.contains('dark') ? '‚òÄÔ∏è' : 'üåô';
    }
    
    // Set initial icon
    updateIcon();

    btn.addEventListener('click', () => {
      if (html.classList.contains('dark')) {
        html.classList.remove('dark');
        localStorage.theme = 'light';
      } else {
        html.classList.add('dark');
        localStorage.theme = 'dark';
      }
      updateIcon();
    });

    // Copy Code Functionality
    document.querySelectorAll('pre').forEach(pre => {
      const button = document.createElement('button');
      button.className = 'copy-button';
      button.textContent = 'Copy';
      button.setAttribute('aria-label', 'Copy code to clipboard');

      pre.appendChild(button);

      button.addEventListener('click', async () => {
        const code = pre.querySelector('code');
        if (!code) return;

        try {
          await navigator.clipboard.writeText(code.innerText);
          button.textContent = 'Copied!';
          setTimeout(() => {
            button.textContent = 'Copy';
          }, 2000);
        } catch (err) {
          console.error('Failed to copy:', err);
          button.textContent = 'Error';
        }
      });
    });
  </script>
</body>
</html>
