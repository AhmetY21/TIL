<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Causal Discovery (Careful: What it can and cannot do)</title>
  <script>
    if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
      document.documentElement.classList.add('dark');
    } else {
      document.documentElement.classList.remove('dark');
    }
  </script>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      line-height: 1.6;
      max-width: 900px;
      margin: 0 auto;
      padding: 24px;
      color: #111827;
      background: #ffffff;
    }
    h1, h2, h3 { color: #111827; }
    a { color: #2563eb; text-decoration: none; }
    a:hover { text-decoration: underline; }
    code { background-color: #f3f4f6; padding: 2px 6px; border-radius: 6px; }
    pre { background-color: #0b1020; color: #e5e7eb; padding: 16px; border-radius: 10px; overflow-x: auto; }
    pre code { background: transparent; padding: 0; }
    blockquote { border-left: 4px solid #e5e7eb; margin: 0; padding-left: 16px; color: #4b5563; }
    table { width: 100%; border-collapse: collapse; margin: 16px 0; }
    th, td { border: 1px solid #e5e7eb; padding: 8px; text-align: left; }
    th { background: #f9fafb; }
    hr { border: none; border-top: 1px solid #e5e7eb; margin: 24px 0; }

    .page-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 24px;
      padding-bottom: 16px;
      border-bottom: 1px solid #e5e7eb;
    }
    .back-link {
      font-weight: 600;
      text-decoration: none;
    }
    .back-link:hover {
      text-decoration: underline;
    }

    .theme-toggle {
      background: none;
      border: none;
      cursor: pointer;
      font-size: 1.5rem;
      padding: 8px;
      border-radius: 50%;
      transition: background 0.2s;
    }
    .theme-toggle:hover {
      background: rgba(0,0,0,0.05);
    }
    .dark .theme-toggle:hover {
      background: rgba(255,255,255,0.1);
    }

    .dark body {
      background: #0f172a;
      color: #e2e8f0;
    }
    .dark h1, .dark h2, .dark h3 { color: #f1f5f9; }
    .dark a { color: #60a5fa; }
    .dark .page-header { border-bottom-color: #334155; }
    .dark code { background-color: #1e293b; color: #e2e8f0; }
    .dark pre {
      border: 1px solid #334155;
    }
    .dark blockquote {
      border-left-color: #334155;
      color: #94a3b8;
    }
    .dark th, .dark td { border-color: #334155; }
    .dark th { background: #1e293b; }
    .dark hr { border-top-color: #334155; }

    /* Copy Button */
    pre { position: relative; }
    .copy-button {
      position: absolute;
      top: 8px;
      right: 8px;
      padding: 4px 8px;
      font-size: 0.8rem;
      color: #94a3b8;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 4px;
      cursor: pointer;
      opacity: 0;
      transition: opacity 0.2s, background 0.2s;
    }
    pre:hover .copy-button, .copy-button:focus {
      opacity: 1;
    }
    .copy-button:hover {
      background: rgba(255, 255, 255, 0.2);
      color: #e2e8f0;
    }

    .skip-link {
      position: absolute;
      top: -40px;
      left: 0;
      background: #2563eb;
      color: white;
      padding: 8px;
      z-index: 100;
    }
    .skip-link:focus {
      top: 0;
    }

  </style>
</head>
<body>
  <a href="#main-content" class="skip-link">Skip to content</a>

  <div class="page-header">
    <a href="../../../../../hubs/causal-inference-index.html" class="back-link">‚Üê Back to Causal Inference</a>
    <button id="theme-toggle" class="theme-toggle" aria-label="Toggle Dark Mode">üåô</button>
  </div>

<main id="main-content" tabindex="-1">
<h1 id="topic-causal-discovery-careful-what-it-can-and-cannot-do">Topic: Causal Discovery (Careful: What it can and cannot do)</h1>
<h2 id="1-formal-definition-what-is-it-and-how-can-we-use-it">1) Formal definition (what is it, and how can we use it?)</h2>
<p>Causal discovery refers to the process of learning causal relationships from observational data <em>without</em> relying on prior knowledge of the causal structure. It aims to infer a causal graph representing the probabilistic dependencies among variables, where an edge from variable A to variable B suggests that A causally influences B.  Unlike traditional statistical methods that primarily focus on correlations, causal discovery attempts to identify the <em>direction</em> of influence.</p>
<p>Formally, causal discovery algorithms aim to identify the underlying Directed Acyclic Graph (DAG) that best explains the observed data distribution.  A DAG consists of nodes representing variables and directed edges representing causal effects.  A crucial assumption underlying many causal discovery methods is the <strong>Causal Markov Condition</strong>, which states that a variable is independent of its non-descendants given its parents in the DAG.  Another important assumption is the <strong>Faithfulness Assumption</strong>, which states that all conditional independence relations in the data are entailed by the DAG; that is, there are no accidental independencies that would obscure the true causal structure.  Violation of these assumptions can lead to incorrect causal inferences.</p>
<p>Causal discovery can be used for various purposes:</p>
<ul>
<li><strong>Hypothesis Generation:</strong> Identify potential causal relationships that can be further investigated through experiments or interventions.</li>
<li><strong>Mechanism Understanding:</strong> Gain insight into the underlying causal mechanisms that generate observed phenomena.</li>
<li><strong>Policy Evaluation:</strong>  Predict the effects of interventions or policy changes on a system.</li>
<li><strong>Data Exploration:</strong>  Reveal unexpected causal relationships that might be missed by traditional correlation analyses.</li>
</ul>
<p><strong>Limitations (What it cannot do):</strong></p>
<ul>
<li><strong>Cannot guarantee correctness:</strong> Causal discovery methods are not infallible. The inferred causal graph is only as good as the data and the assumptions made by the algorithm. Violations of the Causal Markov Condition and/or the Faithfulness Assumption can lead to erroneous conclusions.</li>
<li><strong>Cannot distinguish between all DAGs:</strong> Several DAGs can be Markov equivalent, meaning they encode the same conditional independence relationships. Causal discovery algorithms can typically only identify the Markov equivalence class, rather than a single DAG. This limitation means that directionality between some variable pairs might remain ambiguous.  These equivalence classes can often be represented using a CPDAG (Completed Partially Directed Acyclic Graph).</li>
<li><strong>Sensitive to data quality:</strong> Noisy data, missing values, and small sample sizes can significantly impact the accuracy of causal discovery algorithms.</li>
<li><strong>Requires strong assumptions:</strong>  As mentioned above, causal discovery relies on assumptions like the Causal Markov Condition and Faithfulness. These assumptions are often difficult to verify in practice.</li>
<li><strong>Difficult with latent variables:</strong>  The presence of unobserved confounders (latent variables) can significantly complicate causal discovery. Many algorithms struggle to handle latent variables effectively, leading to biased causal inferences.</li>
<li><strong>Computational complexity:</strong>  Causal discovery algorithms can be computationally expensive, especially for high-dimensional datasets.</li>
</ul>
<h2 id="2-application-scenario">2) Application scenario</h2>
<p><strong>Scenario:</strong>  Imagine a marketing team wants to understand the causal drivers of customer churn. They have collected data on various customer attributes, such as demographics, purchase history, website activity, and customer service interactions.</p>
<p><strong>Applying Causal Discovery:</strong></p>
<p>The team can use a causal discovery algorithm to identify which factors are most likely to <em>cause</em> customer churn. For example, the algorithm might reveal that frequent website visits combined with a low number of recent purchases causally lead to churn. This is more insightful than simply finding a correlation between website visits and churn because it suggests a potential intervention strategy: improve the purchasing experience for frequent website visitors.</p>
<p><strong>Benefits:</strong></p>
<ul>
<li><strong>Targeted interventions:</strong> Identify the most effective points for intervention to reduce churn.</li>
<li><strong>Reduced experimentation:</strong>  Prioritize experiments based on the inferred causal relationships. Instead of testing every possible intervention, focus on those that are likely to have the greatest impact.</li>
<li><strong>Improved understanding:</strong> Gain a deeper understanding of the underlying drivers of churn.</li>
</ul>
<p><strong>Potential pitfalls:</strong></p>
<ul>
<li><strong>Unobserved confounders:</strong>  If there are unobserved factors that influence both customer attributes and churn (e.g., overall customer satisfaction with the product, which is not directly measured), the causal discovery algorithm might infer spurious relationships.</li>
<li><strong>Incorrect assumptions:</strong>  If the Causal Markov Condition or Faithfulness Assumption is violated, the inferred causal graph might be incorrect. For example, a marketing campaign might accidentally create a near-independence between two variables that would otherwise be causally linked.</li>
</ul>
<h2 id="3-python-method-if-possible">3) Python method (if possible)</h2>
<p>One popular Python library for causal discovery is <code>causaldiscovery</code>.  Here's an example using the PC algorithm, a constraint-based method, which is implemented in the <code>cdt</code> (Causal Discovery Toolbox) package, which is part of the <code>causaldiscovery</code> umbrella package.</p>
<pre class="codehilite"><code class="language-python"># Requires installing the causaldiscovery package (which includes CDT)
# pip install causaldiscovery

import pandas as pd
import numpy as np
from causaldiscovery.cdt.causality.graph import PC

# Generate some synthetic data (replace with your actual data)
np.random.seed(0)
n_samples = 100
x = np.random.normal(0, 1, n_samples)
y = 2*x + np.random.normal(0, 1, n_samples)
z = 0.5*y + np.random.normal(0, 1, n_samples)
data = pd.DataFrame({'X': x, 'Y': y, 'Z': z})

# Initialize the PC algorithm
pc = PC(alpha=0.05)  # Significance level

# Run the algorithm
skeleton = pc.create_skeleton(data)
directed_graph = pc.orient_edges(skeleton, data)

# Print the inferred graph (adjacency matrix)
print(directed_graph.to_adjacency())

# You can also visualize the graph using networkx (requires installing networkx)
# import networkx as nx
# import matplotlib.pyplot as plt

# nx_graph = nx.DiGraph(directed_graph.to_adjacency())
# nx.draw(nx_graph, with_labels=True)
# plt.show()
</code></pre>

<p><strong>Explanation:</strong></p>
<ol>
<li><strong>Data Preparation:</strong> The code first generates some synthetic data.  In a real application, you would replace this with your actual data loaded into a Pandas DataFrame.</li>
<li><strong>Initialization:</strong> The <code>PC</code> class is initialized with a significance level (<code>alpha</code>). This parameter controls the threshold for statistical independence tests.</li>
<li><strong>Algorithm Execution:</strong><ul>
<li><code>create_skeleton()</code>: This method constructs the undirected skeleton of the graph by performing conditional independence tests.</li>
<li><code>orient_edges()</code>: This method orients the edges of the skeleton to create a directed graph (DAG).</li>
</ul>
</li>
<li><strong>Output:</strong> The inferred DAG is represented as an adjacency matrix.  The code also includes commented-out lines to visualize the graph using <code>networkx</code>.</li>
</ol>
<p><strong>Important Notes:</strong></p>
<ul>
<li>This is a simplified example. You may need to tune the parameters of the PC algorithm (e.g., <code>alpha</code>) and explore other causal discovery algorithms depending on your data and the assumptions you are willing to make.</li>
<li>The <code>causaldiscovery</code> package offers several other algorithms, including score-based methods (e.g., GES, LiNGAM) and constraint-based methods other than PC.</li>
<li>Always carefully consider the limitations of causal discovery and validate the inferred causal relationships with domain expertise and, ideally, through interventional experiments.</li>
<li>Ensure that your data is appropriately pre-processed (e.g., handling missing values, scaling numerical features) before running the algorithm.</li>
</ul>
<h2 id="4-follow-up-question">4) Follow-up question</h2>
<p>How can we evaluate the performance of a causal discovery algorithm when we don't know the true causal graph? What metrics or approaches can be used to assess the quality of the inferred causal relationships?</p>
</main>
  <script>
    const btn = document.getElementById('theme-toggle');
    const html = document.documentElement;
    
    function updateIcon() {
      btn.textContent = html.classList.contains('dark') ? '‚òÄÔ∏è' : 'üåô';
    }
    
    // Set initial icon
    updateIcon();

    btn.addEventListener('click', () => {
      if (html.classList.contains('dark')) {
        html.classList.remove('dark');
        localStorage.theme = 'light';
      } else {
        html.classList.add('dark');
        localStorage.theme = 'dark';
      }
      updateIcon();
    });

    // Copy Code Functionality
    document.querySelectorAll('pre').forEach(pre => {
      const button = document.createElement('button');
      button.className = 'copy-button';
      button.textContent = 'Copy';
      button.setAttribute('aria-label', 'Copy code to clipboard');

      pre.appendChild(button);

      button.addEventListener('click', async () => {
        const code = pre.querySelector('code');
        if (!code) return;

        try {
          await navigator.clipboard.writeText(code.innerText);
          button.textContent = 'Copied!';
          setTimeout(() => {
            button.textContent = 'Copy';
          }, 2000);
        } catch (err) {
          console.error('Failed to copy:', err);
          button.textContent = 'Error';
        }
      });
    });
  </script>
</body>
</html>
